# Week 4 - 内存

## 本周主题

深入理解计算机内存的工作原理，学习指针和动态内存分配。

## 主要内容

### 十六进制

- 用0x前缀表示
- 0x0 - 0xF（0-15）
- 常用于表示内存地址

### 指针

指针是存储内存地址的变量：

```c
int n = 50;
int *p = &n;  // p存储n的地址
printf("%p\n", p);   // 打印地址
printf("%d\n", *p);  // 打印值（解引用）
```

- `&` - 取地址运算符
- `*` - 解引用运算符

### 字符串的真相

```c
char *s = "Hello";
// s是指向字符串第一个字符的指针
```

### 动态内存分配

```c
#include <stdlib.h>

// 分配内存
int *arr = malloc(10 * sizeof(int));

// 使用内存
arr[0] = 1;

// 释放内存
free(arr);
```

### 内存布局

```
┌─────────────┐
│   Text      │ ← 代码
├─────────────┤
│   Data      │ ← 全局变量
├─────────────┤
│   Heap      │ ← malloc分配（向下增长）
│     ↓       │
│     ↑       │
│   Stack     │ ← 函数调用（向上增长）
└─────────────┘
```

## 文件操作

```c
FILE *file = fopen("file.txt", "r");
if (file != NULL)
{
    // 读取或写入文件
    fclose(file);
}
```

模式：
- "r" - 读取
- "w" - 写入
- "a" - 追加

## 常见问题

### 内存泄漏
忘记调用`free()`释放分配的内存。

### 悬空指针
使用已经释放的内存。

### 缓冲区溢出
写入超出分配的内存范围。

## 调试工具

### Valgrind
检查内存错误：
```bash
valgrind ./program
```

## Problem Sets

- Volume
- Filter (Less/More)
- Recover

## 学习要点

- 理解指针的本质
- 掌握动态内存管理
- 注意内存安全
- 学会使用调试工具
